<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å - EduPlatform</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/mobile.css" media="(max-width: 1199px)">
    <link rel="stylesheet" href="../css/desktop.css" media="(min-width: 1200px)">
    <link rel="icon" href="../logo/logo.png">
    <style>
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ */
        .admin-section {
            padding: 40px 0;
            min-height: calc(100vh - 140px);
            background-color: #F7F9FC;
        }
        
        .admin-header {
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .admin-header h1 {
            color: #2E3A59;
            margin: 0;
        }
        
        .admin-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }
        
        @media (min-width: 768px) {
            .admin-stats {
                grid-template-columns: repeat(4, 1fr);
            }
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #4A6FA5;
            margin-bottom: 5px;
        }
        
        .stat-label {
            color: #666;
            font-size: 0.9rem;
        }
        
        /* –¢–∞–±—ã –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ */
        .admin-tabs {
            display: flex;
            border-bottom: 2px solid #E0E6EF;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .tab-btn {
            padding: 15px 25px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            color: #666;
            position: relative;
            transition: color 0.3s ease;
        }
        
        .tab-btn:hover {
            color: #4A6FA5;
        }
        
        .tab-btn.active {
            color: #4A6FA5;
            font-weight: 500;
        }
        
        .tab-btn.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background-color: #4A6FA5;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã –∑–∞—è–≤–æ–∫ */
        .table-container {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            overflow-x: auto;
        }
        
        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .table-controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 800px;
        }
        
        th {
            background-color: #F7F9FC;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: #2E3A59;
            border-bottom: 2px solid #E0E6EF;
        }
        
        td {
            padding: 15px;
            border-bottom: 1px solid #E0E6EF;
            vertical-align: top;
        }
        
        tr:hover {
            background-color: #F7F9FC;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —Å—Ç–∞—Ç—É—Å–æ–≤ –∑–∞—è–≤–æ–∫ */
        .status-badge {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.85rem;
            font-weight: 500;
        }
        
        .status-new {
            background-color: #FFF3E0;
            color: #FF9800;
        }
        
        .status-solved {
            background-color: #E8F5E9;
            color: #1A6A3F;
        }
        
        .status-rejected {
            background-color: #FFEBEE;
            color: #D32F2F;
        }
        
        /* –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π */
        .action-buttons {
            display: flex;
            gap: 5px;
        }
        
        .action-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.2s ease;
        }
        
        .btn-solve {
            background-color: #E8F5E9;
            color: #1A6A3F;
        }
        
        .btn-solve:hover {
            background-color: #1A6A3F;
            color: white;
        }
        
        .btn-reject {
            background-color: #FFEBEE;
            color: #D32F2F;
        }
        
        .btn-reject:hover {
            background-color: #D32F2F;
            color: white;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ */
        .categories-management {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .add-category-form {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .add-category-form input {
            flex: 1;
            min-width: 200px;
        }
        
        .categories-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .category-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 1px 5px rgba(0, 0, 0, 0.05);
        }
        
        .category-actions {
            display: flex;
            gap: 5px;
        }
        
        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
        }
        
        .modal.show {
            display: flex;
            animation: fadeIn 0.3s ease;
        }
        
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 10px;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
        }
        
        .modal-header {
            margin-bottom: 20px;
        }
        
        .modal-body {
            margin-bottom: 20px;
        }
        
        .modal-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —Ñ–æ—Ä–º—ã –ø—Ä–∏—á–∏–Ω—ã –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è */
        .reason-form textarea {
            width: 100%;
            min-height: 100px;
            padding: 12px;
            border: 2px solid #E0E6EF;
            border-radius: 6px;
            font-family: inherit;
            resize: vertical;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 6px;
            color: white;
            font-weight: 500;
            z-index: 1001;
            animation: slideInRight 0.3s ease;
            max-width: 300px;
        }
        
        .notification.success {
            background-color: #1A6A3F;
        }
        
        .notification.error {
            background-color: #D32F2F;
        }
        
        .notification.info {
            background-color: #4A6FA5;
        }
        
        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(100%);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .admin-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .table-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .table-controls {
                width: 100%;
            }
            
            .add-category-form {
                flex-direction: column;
            }
            
            .add-category-form input {
                width: 100%;
            }
            
            .category-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .category-actions {
                width: 100%;
                justify-content: flex-end;
            }
            
            .action-buttons {
                flex-wrap: wrap;
            }
        }
        
        /* –ó–∞–≥—Ä—É–∑–∫–∞ */
        .loading {
            display: none;
            text-align: center;
            padding: 40px;
        }
        
        .loading.show {
            display: block;
        }
        
        .loader {
            width: 40px;
            height: 40px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #4A6FA5;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- –®–∞–ø–∫–∞ —Å–∞–π—Ç–∞ -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <a href="../index.html" class="logo">
                    <img src="../logo/logo.png" alt="EduPlatform" class="logo-img">
                    <span class="logo-text">EduPlatform</span>
                </a>
                
                <!-- –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ –º–µ–Ω—é –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö -->
                <nav class="nav mobile-nav">
                    <button class="menu-toggle" id="menuToggle">
                        <span></span>
                        <span></span>
                        <span></span>
                    </button>
                    <ul class="nav-list" id="navList">
                        <li><a href="../index.html">–ì–ª–∞–≤–Ω–∞—è</a></li>
                        <li><a href="#" onclick="logout()">–í—ã—Ö–æ–¥</a></li>
                    </ul>
                </nav>
                
                <!-- –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–µ–Ω—é –¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–æ–≤ -->
                <nav class="nav desktop-nav">
                    <ul class="nav-list">
                        <li><a href="../index.html">–ì–ª–∞–≤–Ω–∞—è</a></li>
                        <li><a href="#" onclick="logout()">–í—ã—Ö–æ–¥</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <main class="main">
        <section class="admin-section">
            <div class="container">
                <div class="admin-header">
                    <h1>üõ†Ô∏è –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h1>
                    <div class="user-info">
                        <span id="adminName">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</span>
                        <button class="btn btn-secondary btn-small" onclick="logout()">–í—ã–π—Ç–∏</button>
                    </div>
                </div>
                
                <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
                <div class="admin-stats">
                    <div class="stat-card">
                        <div class="stat-value" id="totalRequests">0</div>
                        <div class="stat-label">–í—Å–µ–≥–æ –∑–∞—è–≤–æ–∫</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="newRequests">0</div>
                        <div class="stat-label">–ù–æ–≤—ã–µ –∑–∞—è–≤–∫–∏</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="solvedRequests">0</div>
                        <div class="stat-label">–†–µ—à–µ–Ω–æ</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="rejectedRequests">0</div>
                        <div class="stat-label">–û—Ç–∫–ª–æ–Ω–µ–Ω–æ</div>
                    </div>
                </div>
                
                <!-- –¢–∞–±—ã –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ -->
                <div class="admin-tabs">
                    <button class="tab-btn active" onclick="switchTab('requests')">
                        üìã –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–∞–º–∏
                    </button>
                    <button class="tab-btn" onclick="switchTab('categories')">
                        üè∑Ô∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
                    </button>
                </div>
                
                <!-- –í–∫–ª–∞–¥–∫–∞ "–ó–∞—è–≤–∫–∏" -->
                <div class="tab-content active" id="requestsTab">
                    <div class="table-container">
                        <div class="table-header">
                            <h3>–í—Å–µ –∑–∞—è–≤–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h3>
                            <div class="table-controls">
                                <select id="statusFilter" class="form-control" onchange="filterAdminRequests(this.value)">
                                    <option value="all">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
                                    <option value="new">–¢–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ</option>
                                    <option value="solved">–¢–æ–ª—å–∫–æ —Ä–µ—à—ë–Ω–Ω—ã–µ</option>
                                    <option value="rejected">–¢–æ–ª—å–∫–æ –æ—Ç–∫–ª–æ–Ω—ë–Ω–Ω—ã–µ</option>
                                </select>
                                <button class="btn" onclick="refreshRequests()">
                                    üîÑ –û–±–Ω–æ–≤–∏—Ç—å
                                </button>
                            </div>
                        </div>
                        
                        <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ -->
                        <div class="loading" id="requestsLoading">
                            <div class="loader"></div>
                            <p>–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞—è–≤–æ–∫...</p>
                        </div>
                        
                        <!-- –¢–∞–±–ª–∏—Ü–∞ –∑–∞—è–≤–æ–∫ -->
                        <div class="table-wrapper">
                            <table id="requestsTable">
                                <thead>
                                    <tr>
                                        <th>–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è</th>
                                        <th>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</th>
                                        <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                                        <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                                        <th>–°—Ç–∞—Ç—É—Å</th>
                                        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                    </tr>
                                </thead>
                                <tbody id="requestsTableBody">
                                    <!-- –ó–∞—è–≤–∫–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                                </tbody>
                            </table>
                        </div>
                        
                        <!-- –°–æ—Å—Ç–æ—è–Ω–∏–µ "–Ω–µ—Ç –∑–∞—è–≤–æ–∫" -->
                        <div class="empty-state" id="noRequestsMessage" style="display: none; text-align: center; padding: 40px;">
                            <div style="font-size: 3rem; margin-bottom: 15px; opacity: 0.5;">üì≠</div>
                            <h3>–ó–∞—è–≤–æ–∫ –Ω–µ—Ç</h3>
                            <p>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –µ—â–µ –Ω–µ —Å–æ–∑–¥–∞–ª–∏ –Ω–∏ –æ–¥–Ω–æ–π –∑–∞—è–≤–∫–∏.</p>
                        </div>
                    </div>
                </div>
                
                <!-- –í–∫–ª–∞–¥–∫–∞ "–ö–∞—Ç–µ–≥–æ—Ä–∏–∏" -->
                <div class="tab-content" id="categoriesTab">
                    <div class="table-container">
                        <h3 style="margin-bottom: 20px;">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ –∑–∞—è–≤–æ–∫</h3>
                        
                        <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ -->
                        <div class="add-category-form" style="margin-bottom: 30px;">
                            <input 
                                type="text" 
                                id="newCategoryName" 
                                class="form-control" 
                                placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"
                            >
                            <button class="btn" onclick="addCategory()">
                                ‚ûï –î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é
                            </button>
                        </div>
                        
                        <!-- –°–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π -->
                        <div class="categories-list" id="categoriesList">
                            <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                        </div>
                        
                        <!-- –°–æ—Å—Ç–æ—è–Ω–∏–µ "–Ω–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–π" -->
                        <div class="empty-state" id="noCategoriesMessage" style="display: none; text-align: center; padding: 40px;">
                            <div style="font-size: 3rem; margin-bottom: 15px; opacity: 0.5;">üè∑Ô∏è</div>
                            <h3>–ö–∞—Ç–µ–≥–æ—Ä–∏–π –Ω–µ—Ç</h3>
                            <p>–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é –¥–ª—è –∑–∞—è–≤–æ–∫.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- –ü–æ–¥–≤–∞–ª —Å–∞–π—Ç–∞ -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <img src="../logo/logo.png" alt="EduPlatform" class="logo-img">
                    <span class="logo-text">EduPlatform</span>
                </div>
                <div class="footer-info">
                    <p>¬© 2024 –û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
                    <p>–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ -->
    <div class="modal" id="statusModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∑–∞—è–≤–∫–∏</h3>
            </div>
            <div class="modal-body" id="modalBody">
                <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
            <div class="modal-actions">
                <button class="btn" id="modalConfirmBtn">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
                <button class="btn btn-secondary" onclick="closeModal()">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ø—Ä–∏—á–∏–Ω—ã –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è -->
    <div class="modal" id="rejectReasonModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–ü—Ä–∏—á–∏–Ω–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –∑–∞—è–≤–∫–∏</h3>
            </div>
            <div class="modal-body">
                <form id="rejectReasonForm" class="reason-form">
                    <div class="form-group">
                        <label for="rejectReason" class="form-label">–£–∫–∞–∂–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è *</label>
                        <textarea 
                            id="rejectReason" 
                            placeholder="–û–ø–∏—à–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É, –ø–æ –∫–æ—Ç–æ—Ä–æ–π –∑–∞—è–≤–∫–∞ –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è..."
                            required
                        ></textarea>
                        <div class="error-message" id="reasonError" style="display: none;">
                            –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-actions">
                <button class="btn btn-danger" onclick="confirmRejection()">–û—Ç–∫–ª–æ–Ω–∏—Ç—å –∑–∞—è–≤–∫—É</button>
                <button class="btn btn-secondary" onclick="closeRejectModal()">–û—Ç–º–µ–Ω–∞</button>
            </div>
        </div>
    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let currentAdmin = null;
        let allRequests = [];
        let allCategories = [];
        let allUsers = [];
        let currentRequestToUpdate = null;
        
        // –ö–ª—é—á–∏ –¥–ª—è localStorage
        const REQUESTS_KEY = 'eduplatform_requests';
        const CATEGORIES_KEY = 'eduplatform_categories';
        const USERS_KEY = 'users';
        const CURRENT_USER_KEY = 'currentUser';
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            initAdminPanel();
        });
        
        function initAdminPanel() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –∏ –ø—Ä–∞–≤–∞
            checkAdminAuth();
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
            loadAllData();
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –º–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é
            initMobileMenu();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–º—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
            updateAdminInfo();
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
        function checkAdminAuth() {
            const userData = localStorage.getItem(CURRENT_USER_KEY);
            
            if (!userData) {
                // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω, –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤—Ö–æ–¥–∞
                window.location.href = '../login.html?redirect=admin';
                return;
            }
            
            currentAdmin = JSON.parse(userData);
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å - –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
            if (currentAdmin.role !== 'admin') {
                // –ï—Å–ª–∏ –Ω–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä, –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –≤ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç
                window.location.href = '../cabinet.html';
                return;
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
        function loadAllData() {
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
            document.getElementById('requestsLoading').classList.add('show');
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –∑–∞—è–≤–∫–∏
            const savedRequests = localStorage.getItem(REQUESTS_KEY);
            allRequests = savedRequests ? JSON.parse(savedRequests) : [];
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
            const savedCategories = localStorage.getItem(CATEGORIES_KEY);
            allCategories = savedCategories ? JSON.parse(savedCategories) : [];
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            const savedUsers = localStorage.getItem(USERS_KEY);
            allUsers = savedUsers ? JSON.parse(savedUsers) : [];
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            updateStats();
            
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∑–∞—è–≤–∫–∏
            displayAdminRequests();
            
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
            displayCategories();
            
            // –°–∫—Ä—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
            setTimeout(() => {
                document.getElementById('requestsLoading').classList.remove('show');
            }, 500);
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        function updateStats() {
            const total = allRequests.length;
            const newCount = allRequests.filter(r => r.status === 'new').length;
            const solvedCount = allRequests.filter(r => r.status === 'solved').length;
            const rejectedCount = allRequests.filter(r => r.status === 'rejected').length;
            
            document.getElementById('totalRequests').textContent = total;
            document.getElementById('newRequests').textContent = newCount;
            document.getElementById('solvedRequests').textContent = solvedCount;
            document.getElementById('rejectedRequests').textContent = rejectedCount;
        }
        
        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞—è–≤–æ–∫ –≤ —Ç–∞–±–ª–∏—Ü–µ
        function displayAdminRequests(filterStatus = 'all') {
            const tableBody = document.getElementById('requestsTableBody');
            const noRequestsMessage = document.getElementById('noRequestsMessage');
            
            // –û—á–∏—â–∞–µ–º —Ç–∞–±–ª–∏—Ü—É
            tableBody.innerHTML = '';
            
            // –§–∏–ª—å—Ç—Ä—É–µ–º –∑–∞—è–≤–∫–∏
            let filteredRequests = allRequests;
            if (filterStatus !== 'all') {
                filteredRequests = allRequests.filter(request => request.status === filterStatus);
            }
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º –∑–∞—è–≤–∫–∏ –ø–æ –¥–∞—Ç–µ (—Å–Ω–∞—á–∞–ª–∞ –Ω–æ–≤—ã–µ)
            filteredRequests.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
            
            if (filteredRequests.length === 0) {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ "–Ω–µ—Ç –∑–∞—è–≤–æ–∫"
                noRequestsMessage.style.display = 'block';
                return;
            }
            
            // –°–∫—Ä—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ "–Ω–µ—Ç –∑–∞—è–≤–æ–∫"
            noRequestsMessage.style.display = 'none';
            
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∫–∞–∂–¥—É—é –∑–∞—è–≤–∫—É
            filteredRequests.forEach(request => {
                // –ù–∞—Ö–æ–¥–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                const user = allUsers.find(u => u.id === request.userId);
                const userName = user ? (user.fullName || user.login) : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
                
                // –ù–∞—Ö–æ–¥–∏–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é
                const category = allCategories.find(c => c.id === request.categoryId);
                const categoryName = category ? category.name : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è';
                
                // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –¥–∞—Ç—É
                const date = new Date(request.createdAt);
                const formattedDate = date.toLocaleDateString('ru-RU', {
                    day: 'numeric',
                    month: 'short',
                    year: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–ª–∞—Å—Å —Å—Ç–∞—Ç—É—Å–∞
                let statusClass = '';
                let statusText = '';
                
                switch (request.status) {
                    case 'new':
                        statusClass = 'status-new';
                        statusText = '–ù–æ–≤–∞—è';
                        break;
                    case 'solved':
                        statusClass = 'status-solved';
                        statusText = '–†–µ—à–µ–Ω–∞';
                        break;
                    case 'rejected':
                        statusClass = 'status-rejected';
                        statusText = '–û—Ç–∫–ª–æ–Ω–µ–Ω–∞';
                        break;
                }
                
                // –°–æ–∑–¥–∞–µ–º —Å—Ç—Ä–æ–∫—É —Ç–∞–±–ª–∏—Ü—ã
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${formattedDate}</td>
                    <td>${userName}</td>
                    <td>
                        <strong>${request.title}</strong>
                        <br>
                        <small style="color: #666;">${request.description.substring(0, 50)}${request.description.length > 50 ? '...' : ''}</small>
                    </td>
                    <td>${categoryName}</td>
                    <td>
                        <span class="status-badge ${statusClass}">${statusText}</span>
                    </td>
                    <td>
                        <div class="action-buttons">
                            ${request.status === 'new' ? `
                                <button class="action-btn btn-solve" onclick="openSolveModal(${request.id})">
                                    ‚úÖ –†–µ—à–µ–Ω–æ
                                </button>
                                <button class="action-btn btn-reject" onclick="openRejectModal(${request.id})">
                                    ‚ùå –û—Ç–∫–ª–æ–Ω–∏—Ç—å
                                </button>
                            ` : `
                                <span style="color: #666; font-size: 0.9rem;">
                                    ${request.status === 'solved' ? '–°—Ç–∞—Ç—É—Å –∏–∑–º–µ–Ω—ë–Ω' : '–ó–∞—è–≤–∫–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞'}
                                </span>
                            `}
                        </div>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
        }
        
        // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∑–∞—è–≤–æ–∫
        function filterAdminRequests(status) {
            displayAdminRequests(status);
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞—è–≤–æ–∫
        function refreshRequests() {
            loadAllData();
            showNotification('–ó–∞—è–≤–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã', 'info');
        }
        
        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
        function displayCategories() {
            const categoriesList = document.getElementById('categoriesList');
            const noCategoriesMessage = document.getElementById('noCategoriesMessage');
            
            // –û—á–∏—â–∞–µ–º —Å–ø–∏—Å–æ–∫
            categoriesList.innerHTML = '';
            
            if (allCategories.length === 0) {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ "–Ω–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–π"
                noCategoriesMessage.style.display = 'block';
                return;
            }
            
            // –°–∫—Ä—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ "–Ω–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–π"
            noCategoriesMessage.style.display = 'none';
            
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∫–∞–∂–¥—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é
            allCategories.forEach(category => {
                // –°—á–∏—Ç–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞—è–≤–æ–∫ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
                const requestsCount = allRequests.filter(r => r.categoryId === category.id).length;
                
                const categoryItem = document.createElement('div');
                categoryItem.className = 'category-item';
                categoryItem.innerHTML = `
                    <div>
                        <strong>${category.name}</strong>
                        <div style="font-size: 0.85rem; color: #666; margin-top: 5px;">
                            ${requestsCount} –∑–∞—è–≤–æ–∫
                        </div>
                    </div>
                    <div class="category-actions">
                        <button class="btn btn-small btn-secondary" onclick="editCategory(${category.id})">
                            ‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å
                        </button>
                        <button class="btn btn-small btn-danger" onclick="deleteCategory(${category.id})">
                            üóëÔ∏è –£–¥–∞–ª–∏—Ç—å
                        </button>
                    </div>
                `;
                
                categoriesList.appendChild(categoryItem);
            });
        }
        
        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        function addCategory() {
            const input = document.getElementById('newCategoryName');
            const name = input.value.trim();
            
            if (!name) {
                showNotification('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏', 'error');
                input.focus();
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ—Ç –ª–∏ —É–∂–µ —Ç–∞–∫–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
            const existingCategory = allCategories.find(c => c.name.toLowerCase() === name.toLowerCase());
            if (existingCategory) {
                showNotification('–ö–∞—Ç–µ–≥–æ—Ä–∏—è —Å —Ç–∞–∫–∏–º –Ω–∞–∑–≤–∞–Ω–∏–µ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç', 'error');
                input.focus();
                return;
            }
            
            // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é
            const newCategory = {
                id: Date.now(),
                name: name,
                createdAt: new Date().toISOString()
            };
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é
            allCategories.push(newCategory);
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
            localStorage.setItem(CATEGORIES_KEY, JSON.stringify(allCategories));
            
            // –û—á–∏—â–∞–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞
            input.value = '';
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
            displayCategories();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            showNotification('–ö–∞—Ç–µ–≥–æ—Ä–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∞', 'success');
        }
        
        // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        function editCategory(categoryId) {
            const category = allCategories.find(c => c.id === categoryId);
            if (!category) return;
            
            const newName = prompt('–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏:', category.name);
            if (!newName || newName.trim() === '') return;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ
            category.name = newName.trim();
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
            localStorage.setItem(CATEGORIES_KEY, JSON.stringify(allCategories));
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
            displayCategories();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            showNotification('–ö–∞—Ç–µ–≥–æ—Ä–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞', 'success');
        }
        
        // –£–¥–∞–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        function deleteCategory(categoryId) {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –∑–∞—è–≤–∫–∏ –≤ —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
            const requestsInCategory = allRequests.filter(r => r.categoryId === categoryId);
            
            if (requestsInCategory.length > 0) {
                const confirmDelete = confirm(
                    `–í —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –µ—Å—Ç—å ${requestsInCategory.length} –∑–∞—è–≤–æ–∫. ` +
                    `–ï—Å–ª–∏ –≤—ã —É–¥–∞–ª–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é, —ç—Ç–∏ –∑–∞—è–≤–∫–∏ –æ—Å—Ç–∞–Ω—É—Ç—Å—è –±–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏. ` +
                    `–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é?`
                );
                
                if (!confirmDelete) return;
            } else {
                const confirmDelete = confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É –∫–∞—Ç–µ–≥–æ—Ä–∏—é?');
                if (!confirmDelete) return;
            }
            
            // –£–¥–∞–ª—è–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é
            allCategories = allCategories.filter(c => c.id !== categoryId);
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
            localStorage.setItem(CATEGORIES_KEY, JSON.stringify(allCategories));
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
            displayCategories();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            showNotification('–ö–∞—Ç–µ–≥–æ—Ä–∏—è —É–¥–∞–ª–µ–Ω–∞', 'success');
        }
        
        // –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞—è–≤–∫–∏
        function openSolveModal(requestId) {
            currentRequestToUpdate = requestId;
            
            // –ù–∞—Ö–æ–¥–∏–º –∑–∞—è–≤–∫—É
            const request = allRequests.find(r => r.id === requestId);
            if (!request || request.status !== 'new') return;
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
            document.getElementById('modalTitle').textContent = '–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è –∑–∞—è–≤–∫–∏';
            document.getElementById('modalBody').innerHTML = `
                <p>–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –ø–æ–º–µ—Ç–∏—Ç—å –∑–∞—è–≤–∫—É –∫–∞–∫ —Ä–µ—à—ë–Ω–Ω—É—é?</p>
                <p><strong>–ó–∞—è–≤–∫–∞:</strong> ${request.title}</p>
            `;
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
            document.getElementById('modalConfirmBtn').onclick = confirmSolve;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            document.getElementById('statusModal').classList.add('show');
        }
        
        // –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è –∑–∞—è–≤–∫–∏
        function confirmSolve() {
            if (!currentRequestToUpdate) {
                closeModal();
                return;
            }
            
            // –ù–∞—Ö–æ–¥–∏–º –∑–∞—è–≤–∫—É
            const requestIndex = allRequests.findIndex(r => r.id === currentRequestToUpdate);
            if (requestIndex === -1) {
                closeModal();
                return;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏
            allRequests[requestIndex].status = 'solved';
            allRequests[requestIndex].updatedAt = new Date().toISOString();
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
            localStorage.setItem(REQUESTS_KEY, JSON.stringify(allRequests));
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏ —Ç–∞–±–ª–∏—Ü—É
            updateStats();
            displayAdminRequests(document.getElementById('statusFilter').value);
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            closeModal();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            showNotification('–ó–∞—è–≤–∫–∞ –æ—Ç–º–µ—á–µ–Ω–∞ –∫–∞–∫ —Ä–µ—à—ë–Ω–Ω–∞—è', 'success');
        }
        
        // –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –¥–ª—è –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –∑–∞—è–≤–∫–∏
        function openRejectModal(requestId) {
            currentRequestToUpdate = requestId;
            
            // –ù–∞—Ö–æ–¥–∏–º –∑–∞—è–≤–∫—É
            const request = allRequests.find(r => r.id === requestId);
            if (!request || request.status !== 'new') return;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —É–∫–∞–∑–∞–Ω–∏—è –ø—Ä–∏—á–∏–Ω—ã
            document.getElementById('rejectReason').value = '';
            document.getElementById('rejectReasonModal').classList.add('show');
        }
        
        // –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –∑–∞—è–≤–∫–∏
        function confirmRejection() {
            if (!currentRequestToUpdate) {
                closeRejectModal();
                return;
            }
            
            const reason = document.getElementById('rejectReason').value.trim();
            
            if (!reason) {
                document.getElementById('reasonError').style.display = 'block';
                return;
            }
            
            // –ù–∞—Ö–æ–¥–∏–º –∑–∞—è–≤–∫—É
            const requestIndex = allRequests.findIndex(r => r.id === currentRequestToUpdate);
            if (requestIndex === -1) {
                closeRejectModal();
                return;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏ –∏ –¥–æ–±–∞–≤–ª—è–µ–º –ø—Ä–∏—á–∏–Ω—É
            allRequests[requestIndex].status = 'rejected';
            allRequests[requestIndex].rejectionReason = reason;
            allRequests[requestIndex].updatedAt = new Date().toISOString();
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
            localStorage.setItem(REQUESTS_KEY, JSON.stringify(allRequests));
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∏ —Ç–∞–±–ª–∏—Ü—É
            updateStats();
            displayAdminRequests(document.getElementById('statusFilter').value);
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            closeRejectModal();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            showNotification('–ó–∞—è–≤–∫–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞', 'success');
        }
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        function closeModal() {
            document.getElementById('statusModal').classList.remove('show');
            currentRequestToUpdate = null;
        }
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–∏—á–∏–Ω—ã –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è
        function closeRejectModal() {
            document.getElementById('rejectReasonModal').classList.remove('show');
            document.getElementById('reasonError').style.display = 'none';
            currentRequestToUpdate = null;
        }
        
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
        function switchTab(tabName) {
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫ –∏ –≤–∫–ª–∞–¥–æ–∫
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–Ω–æ–ø–∫–µ –∏ –≤–∫–ª–∞–¥–∫–µ
            document.querySelector(`[onclick="switchTab('${tabName}')"]`).classList.add('active');
            document.getElementById(`${tabName}Tab`).classList.add('active');
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–µ
        function updateAdminInfo() {
            if (currentAdmin) {
                document.getElementById('adminName').textContent = 
                    currentAdmin.fullName || currentAdmin.login || '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä';
            }
        }
        
        // –í—ã—Ö–æ–¥ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞
        function logout() {
            // –£–¥–∞–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            localStorage.removeItem(CURRENT_USER_KEY);
            
            // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
            window.location.href = '../index.html';
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        function showNotification(message, type = 'success') {
            // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            // –î–æ–±–∞–≤–ª—è–µ–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É
            document.body.appendChild(notification);
            
            // –£–¥–∞–ª—è–µ–º —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                notification.style.animation = 'slideInRight 0.3s ease reverse';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –º–µ–Ω—é
        function initMobileMenu() {
            const menuToggle = document.getElementById('menuToggle');
            const navList = document.getElementById('navList');
            
            if (menuToggle && navList) {
                menuToggle.addEventListener('click', function() {
                    navList.style.display = navList.style.display === 'flex' ? 'none' : 'flex';
                    menuToggle.classList.toggle('active');
                });
            }
        }
    </script>
</body>
</html>